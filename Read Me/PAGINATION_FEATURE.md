# ویژگی صفحه‌بندی برای CustomTableWidget

## 📋 خلاصه
ویژگی صفحه‌بندی به کلاس `CustomTableWidget` اضافه شده است که امکان نمایش داده‌ها در صفحات مختلف را فراهم می‌کند. این ویژگی عملکرد برنامه را بهبود می‌دهد و تجربه کاربری بهتری ارائه می‌دهد.

## ✨ ویژگی‌های اضافه شده

### 1. **ویجت صفحه‌بندی (PaginationWidget)**
- نمایش اطلاعات صفحه (نمایش X تا Y از Z آیتم)
- دکمه‌های ناوبری (اول، قبل، بعد، آخر)
- انتخاب تعداد آیتم در هر صفحه (25، 50، 100، 200، 500)
- شماره صفحه فعلی
- رابط کاربری فارسی و راست‌چین

### 2. **بهینه‌سازی کوئری دیتابیس**
- استفاده از `LIMIT` و `OFFSET` برای صفحه‌بندی
- محاسبه تعداد کل آیتم‌ها برای نمایش صحیح اطلاعات
- بهینه‌سازی عملکرد برای جداول بزرگ

### 3. **مدیریت حالت**
- بازگشت به صفحه اول هنگام جستجو
- بازگشت به صفحه اول هنگام تغییر فیلتر
- حفظ فیلترها هنگام تغییر صفحه

## 🔧 نحوه استفاده

### در CustomTableWidget
```python
# ویجت صفحه‌بندی به طور خودکار اضافه می‌شود
table_widget = CustomTableWidget("lines", headers, column_names, db)

# کنترل نمایش/عدم نمایش صفحه‌بندی
table_widget.set_pagination_visible(True)  # یا False

# دسترسی به ویجت صفحه‌بندی
pagination = table_widget.get_pagination_widget()
```

### تنظیمات صفحه‌بندی
```python
# تنظیم تعداد آیتم در هر صفحه
pagination.set_items_per_page(100)

# رفتن به صفحه مشخص
pagination.set_current_page(3)

# دریافت اطلاعات صفحه فعلی
offset = pagination.get_offset()  # برای کوئری دیتابیس
limit = pagination.get_limit()    # برای کوئری دیتابیس
```

## 📊 عملکرد

### قبل از صفحه‌بندی
- تمام داده‌ها در یک جدول نمایش داده می‌شد
- برای جداول بزرگ، عملکرد کند بود
- اسکرول طولانی برای یافتن آیتم‌ها

### بعد از صفحه‌بندی
- داده‌ها در صفحات 25-500 آیتمی تقسیم می‌شوند
- عملکرد سریع‌تر برای جداول بزرگ
- ناوبری آسان بین صفحات
- نمایش اطلاعات دقیق (مثلاً: نمایش 51 تا 100 از 150 آیتم)

## 🎨 رابط کاربری

### طراحی
- **راست‌چین**: مناسب برای زبان فارسی
- **فونت Vazir**: سازگار با بقیه برنامه
- **رنگ‌بندی**: هماهنگ با تم برنامه
- **دکمه‌های تعاملی**: با hover effects

### عناصر رابط
1. **اطلاعات صفحه**: "نمایش X تا Y از Z آیتم"
2. **انتخاب تعداد**: کمبوباکس برای انتخاب 25، 50، 100، 200، 500
3. **دکمه‌های ناوبری**: << < > >>
4. **شماره صفحه**: "صفحه X از Y"

## 🔄 تغییرات در کد

### فایل‌های تغییر یافته
- `modules/custom_widgets.py`

### کلاس‌های اضافه شده
- `PaginationWidget`: ویجت صفحه‌بندی

### متدهای تغییر یافته
- `CustomTableWidget.__init__()`: اضافه کردن ویجت صفحه‌بندی
- `CustomTableWidget.load_table()`: پشتیبانی از LIMIT/OFFSET
- `CustomTableWidget.perform_search()`: بازگشت به صفحه اول
- `CustomTableWidget.on_column_filter_changed()`: بازگشت به صفحه اول

### متدهای جدید
- `CustomTableWidget.on_page_changed()`: مدیریت تغییر صفحه
- `CustomTableWidget.set_pagination_visible()`: کنترل نمایش
- `CustomTableWidget.get_pagination_widget()`: دسترسی به ویجت

## 🧪 تست‌ها

### تست‌های انجام شده
1. **منطق صفحه‌بندی**: محاسبه صحیح صفحات و offset
2. **تولید کوئری SQL**: صحت LIMIT و OFFSET
3. **مدیریت حالت**: بازگشت به صفحه اول
4. **رابط کاربری**: نمایش صحیح اطلاعات

### نتایج تست
- ✅ محاسبه صحیح تعداد صفحات
- ✅ تولید کوئری SQL صحیح
- ✅ مدیریت offset و limit
- ✅ بازگشت به صفحه اول هنگام جستجو

## 📈 مزایا

### عملکرد
- **سرعت بیشتر**: بارگذاری فقط داده‌های مورد نیاز
- **حافظه کمتر**: عدم بارگذاری تمام داده‌ها
- **پاسخ سریع‌تر**: برای جداول بزرگ

### تجربه کاربری
- **ناوبری آسان**: دکمه‌های واضح
- **اطلاعات دقیق**: نمایش تعداد دقیق آیتم‌ها
- **کنترل انعطاف‌پذیر**: انتخاب تعداد آیتم در هر صفحه
- **سازگاری**: با فیلترها و جستجو

### نگهداری
- **کد تمیز**: جداسازی منطق صفحه‌بندی
- **قابلیت توسعه**: امکان اضافه کردن ویژگی‌های جدید
- **مستندسازی**: کد کامنت‌گذاری شده

## 🔮 آینده

### ویژگی‌های پیشنهادی
1. **جستجو در صفحه**: جستجو فقط در صفحه فعلی
2. **مرتب‌سازی**: حفظ ترتیب هنگام تغییر صفحه
3. **کش**: ذخیره‌سازی موقت صفحات
4. **نمایش پیشرفته**: نمایش شماره صفحات خاص

### بهینه‌سازی‌های ممکن
1. **Lazy Loading**: بارگذاری تدریجی داده‌ها
2. **Virtual Scrolling**: برای جداول بسیار بزرگ
3. **Caching**: کش کردن نتایج کوئری‌ها

## 📝 نکات مهم

### استفاده در پروژه
- صفحه‌بندی به طور خودکار در تمام جداول فعال است
- نیازی به تغییر کد موجود نیست
- سازگار با تمام ویژگی‌های موجود (فیلتر، جستجو، ویرایش)

### تنظیمات پیش‌فرض
- تعداد آیتم در هر صفحه: 50
- گزینه‌های انتخاب: 25، 50، 100، 200، 500
- بازگشت به صفحه اول: هنگام جستجو و تغییر فیلتر

### سازگاری
- با PyQt5 سازگار است
- با SQLite سازگار است
- با تمام جداول موجود سازگار است

---

**تاریخ اضافه شدن**: 2024  
**نسخه**: 1.0  
**وضعیت**: فعال و تست شده 